* Refactor so as to not do things recursively
